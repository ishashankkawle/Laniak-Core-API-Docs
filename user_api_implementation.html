<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>laniak-core-api Â· Anypoint Studio Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="assets/bootstrap.css" rel="stylesheet">
    <link href="assets/bootstrap-responsive.css" rel="stylesheet">
    <link href="assets/docs.css" rel="stylesheet">
    <link href="assets/prettify.css" rel="stylesheet">
    <link href="assets/scroller.css" rel="stylesheet">

  </head>

  <body data-twttr-rendered="true" data-spy="scroll" data-target=".bs-docs-sidebar"><iframe style="display: none;" id="rufous-sandbox" name="uid13460061790411"></iframe>

    <!-- Navbar
    ================================================== -->

    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid" style="height: 53PX;">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="#" style="float: left;height: 85%;margin-right: 5%;"><img src="./assets/icons/logoW.png" style="height:75%" alt="logo"></a>
          <div class="scroller scroller-left"><img src="./assets/icons/glyphicons_chevron-left.png" alt="scrollLeft"></div>
          <div class="scroller scroller-right"><img src="./assets/icons/glyphicons_chevron-right.png" alt="scrollRight"></div>
          <div class="wrapper">
            <ul class="nav nav-tabs list" id="myTab">
                                                                    <li><a href="./index.html">module_api_implementation</a></li>
                                                                                                            <li class="active"><a href="./user_api_implementation.html">user_api_implementation</a></li>
                                                                                                              <li><a href="./typeProjectMap_api_implementation.html">typeProjectMap_api_implementation</a></li>
                                                                                                              <li><a href="./moduleProjectMap_api_implementation.html">moduleProjectMap_api_implementation</a></li>
                                                                                                              <li><a href="./task_api_implementation.html">task_api_implementation</a></li>
                                                                                                              <li><a href="./userProjectMap_api_implementation.html">userProjectMap_api_implementation</a></li>
                                                                                                              <li><a href="./role_api_implementation.html">role_api_implementation</a></li>
                                                                                                              <li><a href="./common.html">common</a></li>
                                                                                                              <li><a href="./interface.html">interface</a></li>
                                                                                                              <li><a href="./priorityProjectMap_api_implementation.html">priorityProjectMap_api_implementation</a></li>
                                                                                                              <li><a href="./global.html">global</a></li>
                                                                                                              <li><a href="./type_api_implementation.html">type_api_implementation</a></li>
                                                                                                              <li><a href="./priority_api_implementation.html">priority_api_implementation</a></li>
                                                                                                              <li><a href="./project_api_implementation.html">project_api_implementation</a></li>
                                                                                                              <li><a href="./activityworkflow_api_implementation.html">activityworkflow_api_implementation</a></li>
                                                                </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

  <header class="jumbotron subhead" id="overview">
    <div class="container">
      <h1>laniak-core-api</h1>
    </div>
  </header>

  <div class="container">

    <!-- Docs nav
    ================================================== -->
    <div class="row">
      <div class="span3 bs-docs-sidebar">
        <ul class="nav nav-list bs-docs-sidenav affix">
          <li class="nav-header">Flows</li>
                      <li data-toggle="collapse" data-target="#_getUserByIdNav"><a href="#_getUserById"><i class="icon-chevron-right"></i> getUserById</a>
            </li>
            <div id="_getUserByIdNav" class="accordion-body collapse" style="height: 0px;">
              <div class="accordion-inner">
                <ul>
                                                                                                              </ul>
              </div>
            </div>
                      <li data-toggle="collapse" data-target="#_getUserIdFromEmailNav"><a href="#_getUserIdFromEmail"><i class="icon-chevron-right"></i> getUserIdFromEmail</a>
            </li>
            <div id="_getUserIdFromEmailNav" class="accordion-body collapse" style="height: 0px;">
              <div class="accordion-inner">
                <ul>
                                                                                                              </ul>
              </div>
            </div>
                      <li data-toggle="collapse" data-target="#_getUsersFromProjectsOnRoleFilterNav"><a href="#_getUsersFromProjectsOnRoleFilter"><i class="icon-chevron-right"></i> getUsersFromProjectsOnRoleFilter</a>
            </li>
            <div id="_getUsersFromProjectsOnRoleFilterNav" class="accordion-body collapse" style="height: 0px;">
              <div class="accordion-inner">
                <ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </ul>
              </div>
            </div>
                      <li data-toggle="collapse" data-target="#_mainUserFlowNav"><a href="#_mainUserFlow"><i class="icon-chevron-right"></i> mainUserFlow</a>
            </li>
            <div id="_mainUserFlowNav" class="accordion-body collapse" style="height: 0px;">
              <div class="accordion-inner">
                <ul>
                                                                                                                                                    </ul>
              </div>
            </div>
                      <li data-toggle="collapse" data-target="#_createNewUserNav"><a href="#_createNewUser"><i class="icon-chevron-right"></i> createNewUser</a>
            </li>
            <div id="_createNewUserNav" class="accordion-body collapse" style="height: 0px;">
              <div class="accordion-inner">
                <ul>
                                                                                                                                                                                                                                                                                                                                                  </ul>
              </div>
            </div>
                      <li data-toggle="collapse" data-target="#_updateUserFlowNav"><a href="#_updateUserFlow"><i class="icon-chevron-right"></i> updateUserFlow</a>
            </li>
            <div id="_updateUserFlowNav" class="accordion-body collapse" style="height: 0px;">
              <div class="accordion-inner">
                <ul>
                                                                                                                                                                                                                                                                                                                                                                                                                              </ul>
              </div>
            </div>
                      <li data-toggle="collapse" data-target="#_deleteUserFlowNav"><a href="#_deleteUserFlow"><i class="icon-chevron-right"></i> deleteUserFlow</a>
            </li>
            <div id="_deleteUserFlowNav" class="accordion-body collapse" style="height: 0px;">
              <div class="accordion-inner">
                <ul>
                                                                                                                                                                                                                                                                      </ul>
              </div>
            </div>
                  </ul>
      </div>
      <div class="span9">

        <!-- Elements and their descriptions
        ================================================== -->
        <div style="max-height: 640px;width:100%;overflow:auto;">
                      <img src="img/user_api_implementation.png" usemap="#mFlowMap" alt="Mule Configuration Image">
            <map name="mFlowMap">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </map>
                  </div>
        <!--Mule configuration xml code-->
        <div class="accordion-heading">
          <a class="accordion-toggle" data-toggle="collapse" href="#collapseMuleConfiguration">
            Show Mule Configuration XML code...
          </a>
        </div>
        <div id="collapseMuleConfiguration" class="accordion-body collapse" style="height: 0px;">
          <div class="accordion-inner">
              <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;mule xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:db="http://www.mulesoft.org/schema/mule/db" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd"&gt;
    &lt;flow name="getUserById" doc:id="51267987-2ef2-45fe-84a4-7ea5d2f1c67d"&gt; 
        &lt;db:select doc:name="Select" doc:id="15eb3e97-3a80-4b54-b578-fa73d78801e3" config-ref="rdbms_master_db_config"&gt; 
            &lt;db:sql&gt;&lt;![CDATA[SELECT "UserId" , "Name" , "RoleId" , "RoleName" From view_userprojectmap WHERE "UserId" = :userId]]&gt;  &lt;/db:sql&gt;  
            &lt;db:input-parameters&gt;&lt;![CDATA[#[{'userId' : attributes.urlParams.ID}]]]&gt;    &lt;/db:input-parameters&gt; 
        &lt;/db:select&gt;  
        &lt;ee:transform doc:name="Transform Message" doc:id="55cf6904-2145-4736-b2c9-7c22f1e0e105"&gt; 
            &lt;ee:message&gt; 
                &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload]]&gt;  &lt;/ee:set-payload&gt;
            &lt;/ee:message&gt; 
        &lt;/ee:transform&gt; 
    &lt;/flow&gt;  
    &lt;flow name="getUserIdFromEmail" doc:id="c8ce8115-81d4-4874-848e-43471f48e60b"&gt; 
        &lt;db:select doc:name="Select" doc:id="e8ac02e5-2de9-475f-acb8-5d0223296eac" config-ref="rdbms_master_db_config"&gt; 
            &lt;db:sql&gt;&lt;![CDATA[SELECT "UserId" From User_master WHERE "Email" = :email]]&gt; &lt;/db:sql&gt;  
            &lt;db:input-parameters&gt;&lt;![CDATA[#[{'email' : attributes.queryParams.email}]]]&gt;    &lt;/db:input-parameters&gt; 
        &lt;/db:select&gt;  
        &lt;ee:transform doc:name="Transform Message" doc:id="45da084d-c147-4aad-9a96-9c347901e9e5"&gt; 
            &lt;ee:message&gt; 
                &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload]]&gt;  &lt;/ee:set-payload&gt;
            &lt;/ee:message&gt; 
        &lt;/ee:transform&gt; 
    &lt;/flow&gt;  
    &lt;flow name="getUsersFromProjectsOnRoleFilter" doc:id="53d90050-c26e-4804-861b-73103ed99cbf"&gt; 
        &lt;set-variable value="#[attributes.queryParams]" doc:name="Set Variable" doc:id="314a50ab-2468-47fe-bafc-2b8933f8af80" variableName="attributes"/&gt;  
        &lt;db:select doc:name="Select" doc:id="5f062bd8-c1b8-45a2-92d4-42954673d1ea" config-ref="rdbms_master_db_config"&gt; 
            &lt;db:sql&gt;&lt;![CDATA[SELECT "RoleId" From view_userprojectmap WHERE "UserId" = :userId]]&gt;   &lt;/db:sql&gt;  
            &lt;db:input-parameters&gt;&lt;![CDATA[#[{'userId' : attributes.queryParams.userId}]]]&gt;  &lt;/db:input-parameters&gt; 
        &lt;/db:select&gt;  
        &lt;ee:transform doc:name="Transform Message" doc:id="53e044bc-2508-4156-b958-1667b366e7c3"&gt; 
            &lt;ee:message&gt; 
                &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    roleId: payload.RoleId[0],

    query : "SELECT DISTINCT \"UserId\" , \"Name\" , \"RoleId\" , \"RoleName\" FROM view_userprojectmap WHERE \"UserId\"    &lt;&gt; '" ++ vars.attributes.userId ++ "' "

}]]&gt;    &lt;/ee:set-payload&gt;
            &lt;/ee:message&gt; 
        &lt;/ee:transform&gt;  
        &lt;choice doc:name="Project Filter" doc:id="c203cb75-aeab-435d-88d9-32444cd8f474"&gt; 
            &lt;when expression="#[vars.attributes.projectFilter == &amp;quot;same&amp;quot;]"&gt; 
                &lt;ee:transform doc:name="Add same project filter" doc:id="3de987ca-8fd7-4752-b14c-67f82c7c018e"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload ++

{

    query : payload.query ++ "and \"ProjectId\" = '" ++ vars.attributes.projectId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/when&gt;  
            &lt;when expression="#[vars.attributes.projectFilter == &amp;quot;other&amp;quot;]"&gt; 
                &lt;ee:transform doc:name="Add other project filter" doc:id="9593848f-815c-4015-a99b-85f3a60df705"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload ++

{

    query : payload.query ++ "and \"ProjectId\"     &lt;&gt; '" ++ vars.attributes.projectId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/when&gt;  
            &lt;otherwise&gt; 
                &lt;logger level="INFO" doc:name="Logger" doc:id="5f5edcb7-6df9-41ae-b4ef-ae9c39cc93f7" message="LAN -----&amp;gt; No project Filter"/&gt; 
            &lt;/otherwise&gt; 
        &lt;/choice&gt;  
        &lt;choice doc:name="Role Filter" doc:id="72367869-4fb7-4b46-aabe-e431a4db7290"&gt; 
            &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;small&amp;quot;]"&gt; 
                &lt;ee:transform doc:name="Add small role filter" doc:id="39475415-1467-4a19-89fa-4fe0de8d9d36"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\" &gt; '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/when&gt;  
            &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;smaller_and_equal&amp;quot;]"&gt; 
                &lt;ee:transform doc:name="Add small or equal role filter" doc:id="c243070f-efaf-4faf-855a-41578c01877e"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\" &gt;= '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/when&gt;  
            &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;big&amp;quot;]"&gt; 
                &lt;ee:transform doc:name="Add big role filter" doc:id="9ad3aa2d-48b1-41d8-b5c7-14a3e0671495"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\"    &lt; '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/when&gt;  
            &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;bigger_and_equal&amp;quot;]"&gt; 
                &lt;ee:transform doc:name="Add big or equal role filter" doc:id="4f29a2dc-aec0-4e2f-a1c5-6c178a640a96"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\"    &lt;= '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/when&gt;  
            &lt;otherwise&gt; 
                &lt;ee:transform doc:name="Add equal role filter" doc:id="7ddb424b-8304-40b8-8bc1-77061f28bb72"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\" = '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/otherwise&gt; 
        &lt;/choice&gt;  
        &lt;logger level="INFO" doc:name="Logger" doc:id="a8404f6c-f0e6-4354-a192-90de41f0ea04" message="#[&amp;quot;LAN -----&amp;gt; User Data fetch query :: &amp;quot; ++ payload.query]"/&gt;  
        &lt;db:select doc:name="Select" doc:id="b8c40449-301a-4a92-bbf4-b8abb404899e" config-ref="rdbms_master_db_config"&gt; 
            &lt;db:sql&gt;&lt;![CDATA[#[payload.query]]]&gt;    &lt;/db:sql&gt; 
        &lt;/db:select&gt;  
        &lt;ee:transform doc:name="Transform Message" doc:id="b20db5df-0c31-4c44-aa33-6c66eafcdad1"&gt; 
            &lt;ee:message&gt; 
                &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload]]&gt;  &lt;/ee:set-payload&gt;
            &lt;/ee:message&gt; 
        &lt;/ee:transform&gt; 
    &lt;/flow&gt;  
    &lt;flow name="mainUserFlow" doc:id="a2a36444-16e9-451d-bdfc-d4813b99ab10"&gt; 
        &lt;choice doc:name="Choice" doc:id="1d7ec75b-ed17-4816-a9b3-cc8d9b2a21bb"&gt; 
            &lt;when expression="#[isBlank(attributes.queryParams.email)]"&gt; 
                &lt;flow-ref doc:name="getUsersFromProjectsOnRoleFilter" doc:id="b311e115-ff98-41ce-afd4-d3d01364140f" name="getUsersFromProjectsOnRoleFilter"/&gt; 
            &lt;/when&gt;  
            &lt;otherwise&gt; 
                &lt;flow-ref doc:name="getUserIdFromEmail" doc:id="82f00dc8-c7fc-4471-be2f-70c11dd88e54" name="getUserIdFromEmail"/&gt; 
            &lt;/otherwise&gt; 
        &lt;/choice&gt; 
    &lt;/flow&gt;  
    &lt;flow name="createNewUser" doc:id="4cc60c37-6215-4611-bb27-957a39f36438"&gt; 
        &lt;set-variable value="#[payload]" doc:name="Set backup_payload" doc:id="1a78738c-d93c-4324-86b8-d37d223bd713" variableName="backup_payload"/&gt;  
        &lt;flow-ref doc:name="generateNewId" doc:id="827e2412-be73-4af1-b17c-1c3d19515833" name="generateNewId"/&gt;  
        &lt;set-variable value="#[%dw 2.0
output application/json
---
vars.backup_payload ++ {&amp;quot;userId&amp;quot; : payload.nextval}]" doc:name="Reset backup_payload" doc:id="a48a960d-239e-4864-ae14-1afae2fec523" variableName="backup_payload"/&gt;
        &lt;try doc:name="Try" doc:id="5b95f7a2-dd92-48ed-bcf8-3413fae82dae" transactionalAction="ALWAYS_BEGIN"&gt; 
            &lt;db:insert doc:name="User_Master Insert" doc:id="ceefad38-5328-4c20-b938-b6547e6bcdf6" config-ref="rdbms_master_db_config"&gt; 
                &lt;db:sql&gt;&lt;![CDATA[INSERT INTO user_master ("UserId", "Name", "Contact", "DOB", "Email", "UserName", "Password", "RoleId", "DateCreated") VALUES (:userid , :name, :contact, :dob, :email, :username, PGP_SYM_ENCRYPT(:password , 'AES_KEY'), :roleid , CURRENT_DATE)]]&gt;  &lt;/db:sql&gt;  
                &lt;db:input-parameters&gt;&lt;![CDATA[#[{

    "userid" : vars.backup_payload.userId,

    "name" : vars.backup_payload.name,

    "contact" : vars.backup_payload.contact,

    "dob" : vars.backup_payload.dob,

    "email" : vars.backup_payload.email,

    "username" : vars.backup_payload.username,

    "password" : vars.backup_payload.password,

    "roleid" : vars.backup_payload.roleId

}]]]&gt;   &lt;/db:input-parameters&gt;
            &lt;/db:insert&gt;  
            &lt;ee:transform doc:name="Transform Message" doc:id="4a7d6311-b2ce-4f05-ac5b-61904b35f571"&gt; 
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

vars.backup_payload]]&gt;  &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt;  
            &lt;flow-ref doc:name="createNewUserProjectMap" doc:id="b9475733-75ae-4a37-93c2-d47ae349aab4" name="createNewUserProjectMap"/&gt; 
        &lt;/try&gt;  
        &lt;ee:transform doc:name="Transform Message" doc:id="29ee63ce-8d43-4a9f-8d6f-7b300add7d18"&gt; 
            &lt;ee:message&gt; 
                &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

}]]&gt;    &lt;/ee:set-payload&gt;
            &lt;/ee:message&gt; 
        &lt;/ee:transform&gt; 
    &lt;/flow&gt;  
    &lt;flow name="updateUserFlow" doc:id="b82856be-e7fe-4880-8127-9a8ae6b4daad"&gt; 
        &lt;set-variable value="#[payload]" doc:name="Set backup_payload" doc:id="50e9f124-a946-4a3d-870c-af6110005bf4" variableName="backup_payload"/&gt;  
        &lt;choice doc:name="Choice" doc:id="992d63de-b682-4411-9310-751b110d94f0"&gt; 
            &lt;when expression="#[vars.backup_payload.isSecret == &amp;quot;true&amp;quot;]"&gt; 
                &lt;set-payload value="#[%dw 2.0
output application/json
---
&amp;quot;UPDATE user_master SET \&amp;quot;&amp;quot; ++ vars.backup_payload.field ++ &amp;quot;\&amp;quot; = PGP_SYM_ENCRYPT('&amp;quot; ++ vars.backup_payload.fieldValue ++ &amp;quot;' , 'AES_KEY') WHERE \&amp;quot;UserId\&amp;quot; = '&amp;quot; ++ vars.backup_payload.userId ++ &amp;quot;'&amp;quot;]" doc:name="Set Payload" doc:id="a50e36fa-42e8-4037-8c65-1216af03ebbf"/&gt;
                &lt;logger level="INFO" doc:name="Logger" doc:id="b97f518d-8ed7-4575-834f-5cf4866f6a22" message="#[payload]"/&gt;  
                &lt;db:update doc:name="Update" doc:id="bb5515a5-9cec-4f4c-a3b2-95c55642cd3b" config-ref="rdbms_master_db_config"&gt; 
                    &lt;db:sql&gt;&lt;![CDATA[#[payload]]]&gt;  &lt;/db:sql&gt; 
                &lt;/db:update&gt;  
                &lt;logger level="INFO" doc:name="Logger" doc:id="9ade6e10-a4d9-405f-84f8-6e788cb95df5" message="#[%dw 2.0
output application/json
---
payload]"/&gt;
            &lt;/when&gt;  
            &lt;otherwise&gt; 
                &lt;set-payload value="#[%dw 2.0
output application/json
---
&amp;quot;UPDATE user_master SET \&amp;quot;&amp;quot; ++ vars.backup_payload.field ++ &amp;quot;\&amp;quot; = '&amp;quot; ++ vars.backup_payload.fieldValue ++ &amp;quot;' WHERE \&amp;quot;UserId\&amp;quot; = '&amp;quot; ++ vars.backup_payload.userId ++ &amp;quot;'&amp;quot;]" doc:name="Set Payload" doc:id="39e71c61-5564-4617-aaab-8229d04e9fa2"/&gt;
                &lt;logger level="INFO" doc:name="Logger" doc:id="bbad78ae-4f10-4a73-a386-50cf7f826d6d" message="#[payload]"/&gt;  
                &lt;db:update doc:name="Update" doc:id="79d7586e-d268-4ed9-9eb0-873f4560edd8" config-ref="rdbms_master_db_config"&gt; 
                    &lt;db:sql&gt;&lt;![CDATA[#[payload]]]&gt;  &lt;/db:sql&gt; 
                &lt;/db:update&gt;  
                &lt;logger level="INFO" doc:name="Logger" doc:id="2b03cdc6-7877-437f-a808-9f96c9394f52" message="#[%dw 2.0
output application/json
---
payload]"/&gt;
            &lt;/otherwise&gt; 
        &lt;/choice&gt; 
    &lt;/flow&gt;  
    &lt;flow name="deleteUserFlow" doc:id="f2267506-724b-44f9-b8c0-9c3f4f957eef"&gt; 
        &lt;set-variable value="#[payload]" doc:name="Set backup_payload" doc:id="bfcd262e-79bf-407b-8903-7792b7f8fd8f" variableName="backup_payload"/&gt;  
        &lt;db:select doc:name="Select" doc:id="1b71383a-41ad-425e-b193-a565f9f0bfbc" config-ref="rdbms_master_db_config"&gt; 
            &lt;db:sql&gt;&lt;![CDATA[SELECT COUNT(*) FROM task_master WHERE "OWNER" = :userid]]&gt;    &lt;/db:sql&gt;  
            &lt;db:input-parameters&gt;&lt;![CDATA[#[{

    "userid" : vars.backup_payload.userId

}]]]&gt;   &lt;/db:input-parameters&gt;
        &lt;/db:select&gt;  
        &lt;ee:transform doc:name="Transform Message" doc:id="aae641ee-fc6f-4fdc-a3d1-825ba1940f9e"&gt; 
            &lt;ee:message&gt; 
                &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload[0]]]&gt;   &lt;/ee:set-payload&gt;
            &lt;/ee:message&gt; 
        &lt;/ee:transform&gt;  
        &lt;choice doc:name="Choice" doc:id="f2a1c206-8f12-4dff-945a-4b6cb54a8a4a"&gt; 
            &lt;when expression="#[payload.count == 0]"&gt; 
                &lt;db:delete doc:name="Delete" doc:id="599ade28-1905-41b6-bd10-62732f22b496" config-ref="rdbms_master_db_config"&gt; 
                    &lt;db:sql&gt;&lt;![CDATA[DELETE FROM user_project_map WHERE "UserId" = :userid;

DELETE FROM user_master WHERE "UserId" = :userid;]]&gt;    &lt;/db:sql&gt;
                    &lt;db:input-parameters&gt;&lt;![CDATA[#[{

    "userid" : vars.backup_payload.userId

}]]]&gt;   &lt;/db:input-parameters&gt;
                &lt;/db:delete&gt; 
            &lt;/when&gt;  
            &lt;otherwise&gt; 
                &lt;ee:transform doc:name="Transform Message" doc:id="c29517d8-95e6-414a-8477-6842c4eacadf"&gt; 
                    &lt;ee:message&gt; 
                        &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    "message" : "Some tasks are assigned to specified user. Hence cannot be deleted"

}]]&gt;    &lt;/ee:set-payload&gt;
                    &lt;/ee:message&gt; 
                &lt;/ee:transform&gt; 
            &lt;/otherwise&gt; 
        &lt;/choice&gt; 
    &lt;/flow&gt; 
&lt;/mule&gt;
</code></pre>

          </div>
        </div>

                  <section id="_getUserById">
            <div class="page-header">
                <h1>getUserById <img src="./assets/icons/flow.png"></h1>
            </div>
            <div class="documentation-indented" style="height:100%;width:100%;overflow:auto;">
                              <img src="img/getUserById.png" usemap="#flowMapgetUserById" alt="getUserById image">
                <map name="flowMapgetUserById">
                                                                                                              </map>
                          </div>
            <div class="documentation-indented">
              <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" href="#_getUserByIdxml_code">
                  Show configuration XML code of the flow getUserById...
                </a>
              </div>
              <div id="_getUserByIdxml_code" class="accordion-body collapse" style="height: 0px;">
                <div class="accordion-inner">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;flow name="getUserById" doc:id="51267987-2ef2-45fe-84a4-7ea5d2f1c67d"&gt;  
    &lt;db:select doc:name="Select" doc:id="15eb3e97-3a80-4b54-b578-fa73d78801e3" config-ref="rdbms_master_db_config"&gt;  
        &lt;db:sql&gt;&lt;![CDATA[SELECT "UserId" , "Name" , "RoleId" , "RoleName" From view_userprojectmap WHERE "UserId" = :userId]]&gt;  &lt;/db:sql&gt;  
        &lt;db:input-parameters&gt;&lt;![CDATA[#[{'userId' : attributes.urlParams.ID}]]]&gt;    &lt;/db:input-parameters&gt; 
    &lt;/db:select&gt;  
    &lt;ee:transform doc:name="Transform Message" doc:id="55cf6904-2145-4736-b2c9-7c22f1e0e105"&gt;  
        &lt;ee:message&gt; 
            &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload]]&gt;  &lt;/ee:set-payload&gt;
        &lt;/ee:message&gt; 
    &lt;/ee:transform&gt; 
&lt;/flow&gt;
</code></pre>

                </div>
              </div>
              <p></p>
            </div>
                                                                          </section>
                  <section id="_getUserIdFromEmail">
            <div class="page-header">
                <h1>getUserIdFromEmail <img src="./assets/icons/flow.png"></h1>
            </div>
            <div class="documentation-indented" style="height:100%;width:100%;overflow:auto;">
                              <img src="img/getUserIdFromEmail.png" usemap="#flowMapgetUserIdFromEmail" alt="getUserIdFromEmail image">
                <map name="flowMapgetUserIdFromEmail">
                                                                                                              </map>
                          </div>
            <div class="documentation-indented">
              <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" href="#_getUserIdFromEmailxml_code">
                  Show configuration XML code of the flow getUserIdFromEmail...
                </a>
              </div>
              <div id="_getUserIdFromEmailxml_code" class="accordion-body collapse" style="height: 0px;">
                <div class="accordion-inner">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;flow name="getUserIdFromEmail" doc:id="c8ce8115-81d4-4874-848e-43471f48e60b"&gt;  
    &lt;db:select doc:name="Select" doc:id="e8ac02e5-2de9-475f-acb8-5d0223296eac" config-ref="rdbms_master_db_config"&gt;  
        &lt;db:sql&gt;&lt;![CDATA[SELECT "UserId" From User_master WHERE "Email" = :email]]&gt; &lt;/db:sql&gt;  
        &lt;db:input-parameters&gt;&lt;![CDATA[#[{'email' : attributes.queryParams.email}]]]&gt;    &lt;/db:input-parameters&gt; 
    &lt;/db:select&gt;  
    &lt;ee:transform doc:name="Transform Message" doc:id="45da084d-c147-4aad-9a96-9c347901e9e5"&gt;  
        &lt;ee:message&gt; 
            &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload]]&gt;  &lt;/ee:set-payload&gt;
        &lt;/ee:message&gt; 
    &lt;/ee:transform&gt; 
&lt;/flow&gt;
</code></pre>

                </div>
              </div>
              <p></p>
            </div>
                                                                          </section>
                  <section id="_getUsersFromProjectsOnRoleFilter">
            <div class="page-header">
                <h1>getUsersFromProjectsOnRoleFilter <img src="./assets/icons/flow.png"></h1>
            </div>
            <div class="documentation-indented" style="height:100%;width:100%;overflow:auto;">
                              <img src="img/getUsersFromProjectsOnRoleFilter.png" usemap="#flowMapgetUsersFromProjectsOnRoleFilter" alt="getUsersFromProjectsOnRoleFilter image">
                <map name="flowMapgetUsersFromProjectsOnRoleFilter">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </map>
                          </div>
            <div class="documentation-indented">
              <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" href="#_getUsersFromProjectsOnRoleFilterxml_code">
                  Show configuration XML code of the flow getUsersFromProjectsOnRoleFilter...
                </a>
              </div>
              <div id="_getUsersFromProjectsOnRoleFilterxml_code" class="accordion-body collapse" style="height: 0px;">
                <div class="accordion-inner">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;flow name="getUsersFromProjectsOnRoleFilter" doc:id="53d90050-c26e-4804-861b-73103ed99cbf"&gt;  
    &lt;set-variable value="#[attributes.queryParams]" doc:name="Set Variable" doc:id="314a50ab-2468-47fe-bafc-2b8933f8af80" variableName="attributes"/&gt;  
    &lt;db:select doc:name="Select" doc:id="5f062bd8-c1b8-45a2-92d4-42954673d1ea" config-ref="rdbms_master_db_config"&gt;  
        &lt;db:sql&gt;&lt;![CDATA[SELECT "RoleId" From view_userprojectmap WHERE "UserId" = :userId]]&gt;   &lt;/db:sql&gt;  
        &lt;db:input-parameters&gt;&lt;![CDATA[#[{'userId' : attributes.queryParams.userId}]]]&gt;  &lt;/db:input-parameters&gt; 
    &lt;/db:select&gt;  
    &lt;ee:transform doc:name="Transform Message" doc:id="53e044bc-2508-4156-b958-1667b366e7c3"&gt;  
        &lt;ee:message&gt; 
            &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    roleId: payload.RoleId[0],

    query : "SELECT DISTINCT \"UserId\" , \"Name\" , \"RoleId\" , \"RoleName\" FROM view_userprojectmap WHERE \"UserId\"    &lt;&gt; '" ++ vars.attributes.userId ++ "' "

}]]&gt;    &lt;/ee:set-payload&gt;
        &lt;/ee:message&gt; 
    &lt;/ee:transform&gt;  
    &lt;choice doc:name="Project Filter" doc:id="c203cb75-aeab-435d-88d9-32444cd8f474"&gt; 
        &lt;when expression="#[vars.attributes.projectFilter == &amp;quot;same&amp;quot;]"&gt; 
            &lt;ee:transform doc:name="Add same project filter" doc:id="3de987ca-8fd7-4752-b14c-67f82c7c018e"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload ++

{

    query : payload.query ++ "and \"ProjectId\" = '" ++ vars.attributes.projectId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/when&gt;  
        &lt;when expression="#[vars.attributes.projectFilter == &amp;quot;other&amp;quot;]"&gt; 
            &lt;ee:transform doc:name="Add other project filter" doc:id="9593848f-815c-4015-a99b-85f3a60df705"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload ++

{

    query : payload.query ++ "and \"ProjectId\"     &lt;&gt; '" ++ vars.attributes.projectId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/when&gt;  
        &lt;otherwise&gt; 
            &lt;logger level="INFO" doc:name="Logger" doc:id="5f5edcb7-6df9-41ae-b4ef-ae9c39cc93f7" message="LAN -----&amp;gt; No project Filter"/&gt; 
        &lt;/otherwise&gt; 
    &lt;/choice&gt;  
    &lt;choice doc:name="Role Filter" doc:id="72367869-4fb7-4b46-aabe-e431a4db7290"&gt; 
        &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;small&amp;quot;]"&gt; 
            &lt;ee:transform doc:name="Add small role filter" doc:id="39475415-1467-4a19-89fa-4fe0de8d9d36"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\" &gt; '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/when&gt;  
        &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;smaller_and_equal&amp;quot;]"&gt; 
            &lt;ee:transform doc:name="Add small or equal role filter" doc:id="c243070f-efaf-4faf-855a-41578c01877e"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\" &gt;= '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/when&gt;  
        &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;big&amp;quot;]"&gt; 
            &lt;ee:transform doc:name="Add big role filter" doc:id="9ad3aa2d-48b1-41d8-b5c7-14a3e0671495"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\"    &lt; '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/when&gt;  
        &lt;when expression="#[vars.attributes.roleFilter == &amp;quot;bigger_and_equal&amp;quot;]"&gt; 
            &lt;ee:transform doc:name="Add big or equal role filter" doc:id="4f29a2dc-aec0-4e2f-a1c5-6c178a640a96"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\"    &lt;= '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/when&gt;  
        &lt;otherwise&gt; 
            &lt;ee:transform doc:name="Add equal role filter" doc:id="7ddb424b-8304-40b8-8bc1-77061f28bb72"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    query : payload.query ++ "and \"RoleId\" = '" ++ payload.roleId ++"' "

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/otherwise&gt; 
    &lt;/choice&gt;  
    &lt;logger level="INFO" doc:name="Logger" doc:id="a8404f6c-f0e6-4354-a192-90de41f0ea04" message="#[&amp;quot;LAN -----&amp;gt; User Data fetch query :: &amp;quot; ++ payload.query]"/&gt;  
    &lt;db:select doc:name="Select" doc:id="b8c40449-301a-4a92-bbf4-b8abb404899e" config-ref="rdbms_master_db_config"&gt;  
        &lt;db:sql&gt;&lt;![CDATA[#[payload.query]]]&gt;    &lt;/db:sql&gt; 
    &lt;/db:select&gt;  
    &lt;ee:transform doc:name="Transform Message" doc:id="b20db5df-0c31-4c44-aa33-6c66eafcdad1"&gt;  
        &lt;ee:message&gt; 
            &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload]]&gt;  &lt;/ee:set-payload&gt;
        &lt;/ee:message&gt; 
    &lt;/ee:transform&gt; 
&lt;/flow&gt;
</code></pre>

                </div>
              </div>
              <p></p>
            </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                      </section>
                  <section id="_mainUserFlow">
            <div class="page-header">
                <h1>mainUserFlow <img src="./assets/icons/flow.png"></h1>
            </div>
            <div class="documentation-indented" style="height:100%;width:100%;overflow:auto;">
                              <img src="img/mainUserFlow.png" usemap="#flowMapmainUserFlow" alt="mainUserFlow image">
                <map name="flowMapmainUserFlow">
                                                                                                                                                    </map>
                          </div>
            <div class="documentation-indented">
              <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" href="#_mainUserFlowxml_code">
                  Show configuration XML code of the flow mainUserFlow...
                </a>
              </div>
              <div id="_mainUserFlowxml_code" class="accordion-body collapse" style="height: 0px;">
                <div class="accordion-inner">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;flow name="mainUserFlow" doc:id="a2a36444-16e9-451d-bdfc-d4813b99ab10"&gt;  
    &lt;choice doc:name="Choice" doc:id="1d7ec75b-ed17-4816-a9b3-cc8d9b2a21bb"&gt; 
        &lt;when expression="#[isBlank(attributes.queryParams.email)]"&gt; 
            &lt;flow-ref doc:name="getUsersFromProjectsOnRoleFilter" doc:id="b311e115-ff98-41ce-afd4-d3d01364140f" name="getUsersFromProjectsOnRoleFilter"/&gt; 
        &lt;/when&gt;  
        &lt;otherwise&gt; 
            &lt;flow-ref doc:name="getUserIdFromEmail" doc:id="82f00dc8-c7fc-4471-be2f-70c11dd88e54" name="getUserIdFromEmail"/&gt; 
        &lt;/otherwise&gt; 
    &lt;/choice&gt; 
&lt;/flow&gt;
</code></pre>

                </div>
              </div>
              <p></p>
            </div>
                                                                                                    </section>
                  <section id="_createNewUser">
            <div class="page-header">
                <h1>createNewUser <img src="./assets/icons/flow.png"></h1>
            </div>
            <div class="documentation-indented" style="height:100%;width:100%;overflow:auto;">
                              <img src="img/createNewUser.png" usemap="#flowMapcreateNewUser" alt="createNewUser image">
                <map name="flowMapcreateNewUser">
                                                                                                                                                                                                                                                                                                                                                  </map>
                          </div>
            <div class="documentation-indented">
              <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" href="#_createNewUserxml_code">
                  Show configuration XML code of the flow createNewUser...
                </a>
              </div>
              <div id="_createNewUserxml_code" class="accordion-body collapse" style="height: 0px;">
                <div class="accordion-inner">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;flow name="createNewUser" doc:id="4cc60c37-6215-4611-bb27-957a39f36438"&gt;  
    &lt;set-variable value="#[payload]" doc:name="Set backup_payload" doc:id="1a78738c-d93c-4324-86b8-d37d223bd713" variableName="backup_payload"/&gt;  
    &lt;flow-ref doc:name="generateNewId" doc:id="827e2412-be73-4af1-b17c-1c3d19515833" name="generateNewId"/&gt;  
    &lt;set-variable value="#[%dw 2.0
output application/json
---
vars.backup_payload ++ {&amp;quot;userId&amp;quot; : payload.nextval}]" doc:name="Reset backup_payload" doc:id="a48a960d-239e-4864-ae14-1afae2fec523" variableName="backup_payload"/&gt;
    &lt;try doc:name="Try" doc:id="5b95f7a2-dd92-48ed-bcf8-3413fae82dae" transactionalAction="ALWAYS_BEGIN"&gt; 
        &lt;db:insert doc:name="User_Master Insert" doc:id="ceefad38-5328-4c20-b938-b6547e6bcdf6" config-ref="rdbms_master_db_config"&gt;  
            &lt;db:sql&gt;&lt;![CDATA[INSERT INTO user_master ("UserId", "Name", "Contact", "DOB", "Email", "UserName", "Password", "RoleId", "DateCreated") VALUES (:userid , :name, :contact, :dob, :email, :username, PGP_SYM_ENCRYPT(:password , 'AES_KEY'), :roleid , CURRENT_DATE)]]&gt;  &lt;/db:sql&gt;  
            &lt;db:input-parameters&gt;&lt;![CDATA[#[{

    "userid" : vars.backup_payload.userId,

    "name" : vars.backup_payload.name,

    "contact" : vars.backup_payload.contact,

    "dob" : vars.backup_payload.dob,

    "email" : vars.backup_payload.email,

    "username" : vars.backup_payload.username,

    "password" : vars.backup_payload.password,

    "roleid" : vars.backup_payload.roleId

}]]]&gt;   &lt;/db:input-parameters&gt;
        &lt;/db:insert&gt;  
        &lt;ee:transform doc:name="Transform Message" doc:id="4a7d6311-b2ce-4f05-ac5b-61904b35f571"&gt;  
            &lt;ee:message&gt; 
                &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

vars.backup_payload]]&gt;  &lt;/ee:set-payload&gt;
            &lt;/ee:message&gt; 
        &lt;/ee:transform&gt;  
        &lt;flow-ref doc:name="createNewUserProjectMap" doc:id="b9475733-75ae-4a37-93c2-d47ae349aab4" name="createNewUserProjectMap"/&gt; 
    &lt;/try&gt;  
    &lt;ee:transform doc:name="Transform Message" doc:id="29ee63ce-8d43-4a9f-8d6f-7b300add7d18"&gt;  
        &lt;ee:message&gt; 
            &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

}]]&gt;    &lt;/ee:set-payload&gt;
        &lt;/ee:message&gt; 
    &lt;/ee:transform&gt; 
&lt;/flow&gt;
</code></pre>

                </div>
              </div>
              <p></p>
            </div>
                                                                                                                                                                                                                                      </section>
                  <section id="_updateUserFlow">
            <div class="page-header">
                <h1>updateUserFlow <img src="./assets/icons/flow.png"></h1>
            </div>
            <div class="documentation-indented" style="height:100%;width:100%;overflow:auto;">
                              <img src="img/updateUserFlow.png" usemap="#flowMapupdateUserFlow" alt="updateUserFlow image">
                <map name="flowMapupdateUserFlow">
                                                                                                                                                                                                                                                                                                                                                                                                                              </map>
                          </div>
            <div class="documentation-indented">
              <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" href="#_updateUserFlowxml_code">
                  Show configuration XML code of the flow updateUserFlow...
                </a>
              </div>
              <div id="_updateUserFlowxml_code" class="accordion-body collapse" style="height: 0px;">
                <div class="accordion-inner">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;flow name="updateUserFlow" doc:id="b82856be-e7fe-4880-8127-9a8ae6b4daad"&gt;  
    &lt;set-variable value="#[payload]" doc:name="Set backup_payload" doc:id="50e9f124-a946-4a3d-870c-af6110005bf4" variableName="backup_payload"/&gt;  
    &lt;choice doc:name="Choice" doc:id="992d63de-b682-4411-9310-751b110d94f0"&gt; 
        &lt;when expression="#[vars.backup_payload.isSecret == &amp;quot;true&amp;quot;]"&gt; 
            &lt;set-payload value="#[%dw 2.0
output application/json
---
&amp;quot;UPDATE user_master SET \&amp;quot;&amp;quot; ++ vars.backup_payload.field ++ &amp;quot;\&amp;quot; = PGP_SYM_ENCRYPT('&amp;quot; ++ vars.backup_payload.fieldValue ++ &amp;quot;' , 'AES_KEY') WHERE \&amp;quot;UserId\&amp;quot; = '&amp;quot; ++ vars.backup_payload.userId ++ &amp;quot;'&amp;quot;]" doc:name="Set Payload" doc:id="a50e36fa-42e8-4037-8c65-1216af03ebbf"/&gt;
            &lt;logger level="INFO" doc:name="Logger" doc:id="b97f518d-8ed7-4575-834f-5cf4866f6a22" message="#[payload]"/&gt;  
            &lt;db:update doc:name="Update" doc:id="bb5515a5-9cec-4f4c-a3b2-95c55642cd3b" config-ref="rdbms_master_db_config"&gt;  
                &lt;db:sql&gt;&lt;![CDATA[#[payload]]]&gt;  &lt;/db:sql&gt; 
            &lt;/db:update&gt;  
            &lt;logger level="INFO" doc:name="Logger" doc:id="9ade6e10-a4d9-405f-84f8-6e788cb95df5" message="#[%dw 2.0
output application/json
---
payload]"/&gt;
        &lt;/when&gt;  
        &lt;otherwise&gt; 
            &lt;set-payload value="#[%dw 2.0
output application/json
---
&amp;quot;UPDATE user_master SET \&amp;quot;&amp;quot; ++ vars.backup_payload.field ++ &amp;quot;\&amp;quot; = '&amp;quot; ++ vars.backup_payload.fieldValue ++ &amp;quot;' WHERE \&amp;quot;UserId\&amp;quot; = '&amp;quot; ++ vars.backup_payload.userId ++ &amp;quot;'&amp;quot;]" doc:name="Set Payload" doc:id="39e71c61-5564-4617-aaab-8229d04e9fa2"/&gt;
            &lt;logger level="INFO" doc:name="Logger" doc:id="bbad78ae-4f10-4a73-a386-50cf7f826d6d" message="#[payload]"/&gt;  
            &lt;db:update doc:name="Update" doc:id="79d7586e-d268-4ed9-9eb0-873f4560edd8" config-ref="rdbms_master_db_config"&gt;  
                &lt;db:sql&gt;&lt;![CDATA[#[payload]]]&gt;  &lt;/db:sql&gt; 
            &lt;/db:update&gt;  
            &lt;logger level="INFO" doc:name="Logger" doc:id="2b03cdc6-7877-437f-a808-9f96c9394f52" message="#[%dw 2.0
output application/json
---
payload]"/&gt;
        &lt;/otherwise&gt; 
    &lt;/choice&gt; 
&lt;/flow&gt;
</code></pre>

                </div>
              </div>
              <p></p>
            </div>
                                                                                                                                                                                                                                                                                          </section>
                  <section id="_deleteUserFlow">
            <div class="page-header">
                <h1>deleteUserFlow <img src="./assets/icons/flow.png"></h1>
            </div>
            <div class="documentation-indented" style="height:100%;width:100%;overflow:auto;">
                              <img src="img/deleteUserFlow.png" usemap="#flowMapdeleteUserFlow" alt="deleteUserFlow image">
                <map name="flowMapdeleteUserFlow">
                                                                                                                                                                                                                                                                      </map>
                          </div>
            <div class="documentation-indented">
              <div class="accordion-heading">
                                <a class="accordion-toggle" data-toggle="collapse" href="#_deleteUserFlowxml_code">
                  Show configuration XML code of the flow deleteUserFlow...
                </a>
              </div>
              <div id="_deleteUserFlowxml_code" class="accordion-body collapse" style="height: 0px;">
                <div class="accordion-inner">
                    <pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;flow name="deleteUserFlow" doc:id="f2267506-724b-44f9-b8c0-9c3f4f957eef"&gt;  
    &lt;set-variable value="#[payload]" doc:name="Set backup_payload" doc:id="bfcd262e-79bf-407b-8903-7792b7f8fd8f" variableName="backup_payload"/&gt;  
    &lt;db:select doc:name="Select" doc:id="1b71383a-41ad-425e-b193-a565f9f0bfbc" config-ref="rdbms_master_db_config"&gt;  
        &lt;db:sql&gt;&lt;![CDATA[SELECT COUNT(*) FROM task_master WHERE "OWNER" = :userid]]&gt;    &lt;/db:sql&gt;  
        &lt;db:input-parameters&gt;&lt;![CDATA[#[{

    "userid" : vars.backup_payload.userId

}]]]&gt;   &lt;/db:input-parameters&gt;
    &lt;/db:select&gt;  
    &lt;ee:transform doc:name="Transform Message" doc:id="aae641ee-fc6f-4fdc-a3d1-825ba1940f9e"&gt;  
        &lt;ee:message&gt; 
            &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

payload[0]]]&gt;   &lt;/ee:set-payload&gt;
        &lt;/ee:message&gt; 
    &lt;/ee:transform&gt;  
    &lt;choice doc:name="Choice" doc:id="f2a1c206-8f12-4dff-945a-4b6cb54a8a4a"&gt; 
        &lt;when expression="#[payload.count == 0]"&gt; 
            &lt;db:delete doc:name="Delete" doc:id="599ade28-1905-41b6-bd10-62732f22b496" config-ref="rdbms_master_db_config"&gt;  
                &lt;db:sql&gt;&lt;![CDATA[DELETE FROM user_project_map WHERE "UserId" = :userid;

DELETE FROM user_master WHERE "UserId" = :userid;]]&gt;    &lt;/db:sql&gt;
                &lt;db:input-parameters&gt;&lt;![CDATA[#[{

    "userid" : vars.backup_payload.userId

}]]]&gt;   &lt;/db:input-parameters&gt;
            &lt;/db:delete&gt; 
        &lt;/when&gt;  
        &lt;otherwise&gt; 
            &lt;ee:transform doc:name="Transform Message" doc:id="c29517d8-95e6-414a-8477-6842c4eacadf"&gt;  
                &lt;ee:message&gt; 
                    &lt;ee:set-payload&gt;&lt;![CDATA[%dw 2.0

output application/json

---

{

    "message" : "Some tasks are assigned to specified user. Hence cannot be deleted"

}]]&gt;    &lt;/ee:set-payload&gt;
                &lt;/ee:message&gt; 
            &lt;/ee:transform&gt; 
        &lt;/otherwise&gt; 
    &lt;/choice&gt; 
&lt;/flow&gt;
</code></pre>

                </div>
              </div>
              <p></p>
            </div>
                                                                                                                                                                                  </section>
              </div>
    </div>
  </div>

<!-- Footer
    ================================================== -->
    <footer class="footer">
      <div class="container">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p>Designed and built with <a href="http://www.mulesoft.com/mule-studio/" target="_blank">Anypoint Studio</a>.</p>
        <p>Code licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License v2.0</a>. Documentation licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
        <p>Icons from <a href="http://glyphicons.com/">Glyphicons Free</a>, licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p>
        <ul class="footer-links">
          <li><a href="http://blogs.mulesoft.org/">Read the blog</a></li>
          <li><a href="http://www.mulesoft.org/jira/browse/">Submit issues</a></li>
        </ul>
      </div>
    </footer>



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="assets/widgets.js"></script>
    <script src="assets/jquery.js"></script>
    <script src="assets/prettify.js"></script>
    <script src="assets/bootstrap-transition.js"></script>
    <script src="assets/bootstrap-alert.js"></script>
    <script src="assets/bootstrap-modal.js"></script>
    <script src="assets/bootstrap-dropdown.js"></script>
    <script src="assets/bootstrap-scrollspy.js"></script>
    <script src="assets/bootstrap-tab.js"></script>
    <script src="assets/bootstrap-tooltip.js"></script>
    <script src="assets/bootstrap-popover.js"></script>
    <script src="assets/bootstrap-button.js"></script>
    <script src="assets/bootstrap-collapse.js"></script>
    <script src="assets/bootstrap-carousel.js"></script>
    <script src="assets/bootstrap-typeahead.js"></script>
    <script src="assets/bootstrap-affix.js"></script>
    <script src="assets/scroller.js"></script>
    <script src="assets/application.js"></script>

</body>
</html>
